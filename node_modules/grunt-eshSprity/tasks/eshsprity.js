'use strict';

var sprity = require('esh-sprity');

module.exports = function(grunt) {
	var logger = {
		log: function(msg) {
			grunt.log.writeln(msg);
		},
		warn: function(msg) {
			grunt.log.debug(msg, 'warn');
		},
		debug: function(msg) {
			grunt.log.debug(msg, 'debug');
		},
		error: function(msg) {
			grunt.log.error(msg, 'error');
		},
		success: function(msg) {
			grunt.log.ok(msg);
		}
	};
	grunt.registerMultiTask('eshsprity', 'eshsprity', function() {

		var options = this.options({
			//输出路径
			out: 'images/original',
			//获取路径
			src: 'images/icon/**/*.png',
			//生成less名称
			style: 'less/sprite/sprite.less',
			//生成类型
			processor: 'esh-sprity-less',
			//图片引擎
			engine: 'sprity-gm',
			//按照文件夹split
			split: true,
			cssPath: '/images/production'
		});
		var done = this.async();

		sprity.create(options, function(e) {
			if (e) {
				grunt.log.error(e.toString());
			} else {
				grunt.log.ok('File created.');
			}
			done();
		});

	})
}